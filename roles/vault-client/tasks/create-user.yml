---
#
# ansible-vault encrypt_string `openssl passwd -1 HRC-Marcus-Garvey`
#

- name: Get User Vault Password
  uri:
    url: "{{ vaultUrl }}"
    method: GET
    headers:
      Content-Type: "application/json"
      X-Vault-Token: 's.a94wPBs0lV5wI1CDp8o2a4SU'
      #X-Vault-Token: '{{unSealToken.stdout}}'
    status_code: 200
    force_basic_auth: yes
  register: ansibleVault

- debug:
    msg: "{{ ansibleVault.json.data.value }}"

- name: Add group {{ user }}
  group:
    name: "{{ vault_user }}"
    gid: "{{ vault_user_id }}"
    state: present


- name: Add user {{ user }}
  user:
    name: "{{ vault_user }}"
    uid: "{{ vault_user_id }}"
    group: "{{ vault_group }}"
    password: "{{ ansibleVault.json.data.value }}"
    home: "/apps/{{ vault_user }}"
    shell: /bin/bash
    skeleton: /etc/skel
    create_home: yes
  tags: [ 'vault_user', 'vault_installdir' ]
...
